<head>
    <title>Editar Enfermera</title>
    <!-- Asegúrate de incluir las referencias necesarias -->
    <link rel="stylesheet" href="/main-edit.css">
    <link rel="stylesheet" href="/side-bar.css">
    <link rel="stylesheet" href="/main-paciente.css">
</head>

<body>
    <div class="back-button">
        <a href="/usuario-enfermera" onclick="goBack()" class="btn btn-secondary boton-volver">
            <span class="fa fa-arrow-left fa-3 boton-volver"></span> Regresar
        </a>
    </div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                {{#if user}}
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Información de la enfermera</h3>
                    </div>
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-4">
                                <div class="avatar-circle">
                                    <img src="{{user.photoUrl}}" alt="Foto de {{user.id}}" width="100">
                                </div>
                            </div>
                            <div class="col-md-8">
                                <p class="mb-1">Nombre: {{user.nombre}} {{user.primerApellido}} {{user.segundoApellido}}
                                </p>
                                <p class="mb-1">Email: {{user.email}}</p>
                                <p class="mb-1">Domicilio: {{user.domicilio}}</p>
                                <p class="mb-1">Telefono: {{user.telefono}}</p>
                                <p class="mb-1">ID: {{user.id}}</p>
                                <!-- Agregado para mostrar el ID -->
                                <label for="tipoCategoria" class="form-label">Categoría:</label>
                                <select class="form-select rounded-pill py-1 px-3 custom-bg-color" id="categoria"
                                    onchange="actualizarCategoriaEnfermera('{{user.id}}', this.value)">
                                    <option value="Basico" {{#ifCondEdit user.categoria '===' 'Basico'
                                        }}selected{{/ifCondEdit}}>Básico</option>
                                    <option value="Intermedio" {{#ifCondEdit user.categoria '===' 'Intermedio'
                                        }}selected{{/ifCondEdit}}>Intermedio</option>
                                    <option value="Avanzado" {{#ifCondEdit user.categoria '===' 'Avanzado'
                                        }}selected{{/ifCondEdit}}>Avanzado</option>
                                </select>
                                <!-- Agrega más campos aquí -->
                            </div>
                        </div>
                    </div>
                </div>
                {{else}}
                <p>Usuario no encontrado</p>
                {{/if}}
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Documentos</h3>
                    </div>
                    <div class="card-body">
                        {{#if user}}
                        <div class="row">
                            <div class="col-md-3">
                                <div class="card document-card mb-4">
                                    <div class="card-header">
                                        <h4 class="text-center"> <br>INE</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.ine}}
                                        <a href="{{user.ine}}" target="_blank" class="btn btn-primary">Ver Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'ine')">Anular Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card">
                                    <div class="card-header">
                                        <h4 class="text-center"> <br> CURP</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.curp}}
                                        <a href="{{user.curp}}" target="_blank" class="btn btn-primary">Ver
                                            Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'curp')">Anular Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card">
                                    <div class="card-header">
                                        <h4 class="text-center two-line-text">Cédula <br> Profesional</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.cedulaProfecional}}
                                        <a href="{{user.cedulaProfecional}}" target="_blank" class="btn btn-primary">Ver
                                            Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'cedulaProfecional')">Anular Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card">
                                    <div class="card-header">
                                        <h4 class="text-center">Título <br> Profesional</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.tituloProfecional}}
                                        <a href="{{user.tituloProfecional}}" target="_blank"
                                            class="btn btn-primary">Ver Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'tituloProfecional')">Anular
                                            Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card mb-4">
                                    <div class="card-header">
                                        <h4 class="text-center">Comprobante de Domicilio</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.comprobanteDomicilio}}
                                        <a href="{{user.comprobanteDomicilio}}" target="_blank"
                                            class="btn btn-primary">Ver Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'comprobanteDomicilio')">Anular
                                            Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card mb-4">
                                    <div class="card-header">
                                        <h4 class="text-center">Primer <br> Referencia</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.referenciaUno}}
                                        <a href="{{user.referenciaUno}}" target="_blank"
                                            class="btn btn-primary">Ver Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'referenciaUno')">Anular
                                            Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card document-card mb-4">
                                    <div class="card-header">
                                        <h4 class="text-center">Segunda <br> Referencia</h4>
                                    </div>
                                    <div class="card-body text-center">
                                        {{#if user.referenciaDos}}
                                        <a href="{{user.referenciaDos}}" target="_blank"
                                            class="btn btn-primary">Ver Documento</a>
                                        <button class="btn btn-danger mt-2"
                                            onclick="anularDocumento('{{user.id}}', 'referenciaDos')">Anular
                                            Documento</button>
                                        {{else}}
                                        <button class="btn btn-primary" disabled>Ver Documento</button>
                                        <button class="btn btn-danger mt-2" disabled>Anular Documento</button>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{else}}
                        <p>Usuario no encontrado</p>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>

        function actualizarCategoriaEnfermera(userId, nuevaCategoria) {
            if (confirm("¿Estás seguro de que deseas cambiar la categoría?")) {
                fetch(`/usuario-enfermera/actualizar-categoria/${userId}/${nuevaCategoria}`, {
                    method: 'POST',
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Categoría actualizada exitosamente");
                            location.reload();
                        } else {
                            alert("Hubo un error al actualizar la categoría");
                        }
                    })
                    .catch(error => {
                        console.error("Error:", error);
                        alert("Hubo un error en la solicitud");
                    });
            }
        }


        function anularDocumento(userId, tipoDocumento) {
            if (confirm("¿Estás seguro de que deseas anular este documento?")) {
                fetch(`/usuario-enfermera/anular-documento/${userId}/${tipoDocumento}`, {
                    method: 'POST',
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Documento anulado exitosamente");
                            location.reload();
                        } else {
                            alert("Hubo un error al anular el documento");
                        }
                    })
                    .catch(error => {
                        console.error("Error:", error);
                        alert("Hubo un error en la solicitud");
                    });
            }
        }

    </script>

</body>
<head>
    <title>Enfermeras</title>
    <link rel="stylesheet" href="/main-edit.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
</head>

<body>
    <h1>Enfermeras</h1>
    <div class="filter-container parent">
        <div>
            <label for="categoryFilter">Filtrar por categoría:</label>
            <select id="categoryFilter" onchange="filterTableByCategory()">
                <option value="">Todas</option>
                <option value="Basico">Basico</option>
                <option value="Intermedio">Intermedio</option>
                <option value="Avanzado">Avanzado</option>
            </select>
        </div>

        <div>
            <label for="categoryFilterAccess">Filtrar por acceso:</label>
            <select id="categoryFilterAccess" onchange="filterTableByAccess()">
                <option value="">Todas</option>
                <option value="bloqueado">Bloqueado</option>
                <option value="desbloqueado">Permitido</option>
            </select>
        </div>
    </div>
    <table id="miTabla" class="table">
        <thead>
            <tr>
                <th>Foto</th>
                <th>Nombre</th>
                <th>Email</th>
                <th>Categoría</th>
                <th>Acceso</th>
                <th>Detalles</th>
            </tr>
        </thead>
        <tbody>
            {{#each allUsers}}
            <tr data-category="{{this.userData.categoria}}">
                <td><img class="imagen-usuario" src="{{this.userData.photoUrl}}" width="50">
                </td>
                <td>{{this.userData.nombre}} {{this.userData.primerApellido}} {{this.userData.segundoApellido}}</td>
                <td>{{this.userData.email}}</td>
                <td>{{this.userData.categoria}}</td>
                <td data-access="{{this.userData.acceso}}">
                    {{#ifCond this.userData.acceso '===' 'desbloqueado'}}
                    Permitido
                    {{else}}
                    Bloqueado
                    {{/ifCond}}
                </td>
                <td>
                    <a href="/usuario-enfermera/{{id}}">Ver</a>
                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>

            <!-- Agrega un espacio al final de la página -->
        <div style="height: 40px;"></div>

</body>

<script>
    //Filtros por categoria
    function filterTableByCategory() {
        const select = document.getElementById('categoryFilter');
        const selectedCategory = select.value;
        const table = document.querySelector('.table');
        const rows = table.getElementsByTagName('tr');

        for (let i = 1; i < rows.length; i++) {
            const category = rows[i].getAttribute('data-category');
            if (selectedCategory === '' || category === selectedCategory) {
                rows[i].style.display = '';
            } else {
                rows[i].style.display = 'none';
            }
        }
    }

    function filterTableByAccess() {
        const select = document.getElementById('categoryFilterAccess');
        const selectedAccess = select.value;
        const table = document.querySelector('.table');
        const rows = table.getElementsByTagName('tr');

        for (let i = 1; i < rows.length; i++) {
            const accessCell = rows[i].querySelector('[data-access]');
            const access = accessCell.getAttribute('data-access');

            if (selectedAccess === '' || access === selectedAccess.toLowerCase()) {
                rows[i].style.display = '';
            } else {
                rows[i].style.display = 'none';
            }
        }
    }

//Datatables
    $(document).ready(function () {
        $('#miTabla').DataTable({
            "paging": true,    // Habilita la paginación
            "pageLength": 10,  // Número de filas por página
            language: {
                url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json',
            },
            // Puedes personalizar otras opciones aquí según tus necesidades
        });
    });



</script>